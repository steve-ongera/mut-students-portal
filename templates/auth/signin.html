{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign In - Murang'a University Of Technology</title>
    <link rel="icon" id="portalLogo" href="{% static 'mulogo.png' %}" />
    
    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <style>
        /* CSS Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #2E7D32;
            --primary-dark: #1B5E20;
            --primary-light: #E8F5E9;
            --secondary-color: #C62828;
            --secondary-dark: #B71C1C;
            --text-dark: #212121;
            --text-medium: #424242;
            --text-light: #757575;
            --border-color: #E0E0E0;
            --bg-light: #F5F7FA;
            --bg-white: #FFFFFF;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 2px 6px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.18);
            --radius: 5px;
            --transition: all 0.2s ease;
        }
        
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-light);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            color: var(--text-dark);
            line-height: 1.4;
            font-size: 14px;
        }
        
        /* Loader */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-white);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s ease;
        }
        
        .loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .svg-loader {
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Main Container - More Compact */
        .login-container {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }
        
        /* Card Styles - Cleaner, Less Padding */
        .login-card {
            background: var(--bg-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .card-header {
            padding: 30px 30px 20px;
            text-align: center;
            background: var(--bg-white);
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-body {
            padding: 24px 30px 30px;
        }
        
        @media (max-width: 576px) {
            .card-header,
            .card-body {
                padding: 20px 20px 24px;
            }
            
            body {
                padding: 12px;
            }
        }
        
        /* Logo - Smaller */
        .logo {
            height: 60px;
            width: auto;
            margin-bottom: 16px;
        }
        
        /* Typography - More Professional */
        .welcome-text {
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 6px;
            line-height: 1.3;
        }
        
        .subtitle {
            color: var(--text-medium);
            font-size: 0.9rem;
            margin-bottom: 24px;
            font-weight: 400;
        }
        
        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        /* Form Elements - Tighter */
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 0.95rem;
            transition: var(--transition);
            background: var(--bg-white);
            color: var(--text-dark);
            font-family: inherit;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(46, 125, 50, 0.1);
        }
        
        .form-control::placeholder {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* Input Group - Cleaner */
        .input-group {
            position: relative;
            display: flex;
        }
        
        .input-group .form-control {
            padding-right: 40px;
            border-right: none;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        .input-group-append {
            display: flex;
            align-items: center;
            padding: 0 12px;
            background: var(--bg-white);
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 var(--radius) var(--radius) 0;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .input-group-append:hover {
            background: #fafafa;
        }
        
        .toggle-password {
            color: var(--text-medium);
            font-size: 1rem;
        }
        
        /* Checkbox - Compact */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .checkbox-input {
            width: 16px;
            height: 16px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }
        
        .checkbox-label {
            font-size: 0.9rem;
            color: var(--text-medium);
            cursor: pointer;
            user-select: none;
        }
        
        /* Button - Professional */
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            text-decoration: none;
            letter-spacing: 0.3px;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            box-shadow: 0 2px 8px rgba(46, 125, 50, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* Utility Classes - Compact */
        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .text-center {
            text-align: center;
        }
        
        .mt-3 {
            margin-top: 18px;
        }
        
        .mt-4 {
            margin-top: 24px;
        }
        
        .mb-3 {
            margin-bottom: 18px;
        }
        
        /* Links - Better Contrast */
        .forgot-link {
            color: var(--secondary-color);
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .forgot-link:hover {
            color: var(--secondary-dark);
            text-decoration: underline;
        }
        
        .signup-link {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .signup-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        /* Alert Messages - Compact */
        .alert {
            padding: 12px;
            border-radius: var(--radius);
            margin-bottom: 18px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.2s ease;
            border-left: 3px solid;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .alert-success {
            background: rgba(46, 125, 50, 0.08);
            border-left-color: var(--primary-color);
            color: var(--primary-dark);
        }
        
        .alert-error {
            background: rgba(198, 40, 40, 0.08);
            border-left-color: var(--secondary-color);
            color: var(--secondary-dark);
        }
        
        .alert-warning {
            background: rgba(255, 152, 0, 0.08);
            border-left-color: #FF9800;
            color: #EF6C00;
        }
        
        .alert-info {
            background: rgba(33, 150, 243, 0.08);
            border-left-color: #2196F3;
            color: #1565C0;
        }
        
        /* Footer - Compact */
        .footer {
            margin-top: 24px;
            text-align: center;
            color: var(--text-medium);
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .footer a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .copyright {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 0.8rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .welcome-text {
                font-size: 1.3rem;
            }
            
            .login-container {
                max-width: 360px;
            }
        }
        
        @media (max-width: 576px) {
            .login-container {
                max-width: 100%;
            }
            
            .login-card {
                box-shadow: var(--shadow-md);
            }
            
            .flex-between {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .forgot-link {
                text-align: right;
                align-self: flex-end;
            }
            
            .footer {
                font-size: 0.8rem;
            }
            
            .copyright {
                font-size: 0.75rem;
            }
        }
        
        /* Dark Mode - Professional */
        @media (prefers-color-scheme: dark) {
            :root {
                --text-dark: #E0E0E0;
                --text-medium: #B0B0B0;
                --text-light: #808080;
                --border-color: #404040;
                --bg-light: #121212;
                --bg-white: #1E1E1E;
                --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
                --shadow-md: 0 2px 6px rgba(0, 0, 0, 0.4);
                --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.5);
            }
            
            .form-control {
                background: #2A2A2A;
            }
            
            .input-group-append {
                background: #2A2A2A;
            }
            
            .input-group-append:hover {
                background: #333;
            }
            
            .loader {
                background: #121212;
            }
        }
        
        /* Print Styles */
        @media print {
            .login-card {
                box-shadow: none;
                border: 1px solid #000;
            }
            
            .btn {
                background: #000 !important;
                color: #fff !important;
                -webkit-print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <!-- Loader -->
    <div class="loader" id="loader">
        <svg version="1.1" class="svg-loader" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
             x="0px" y="0px" viewBox="0 0 80 80" xml:space="preserve">
            <path fill="#2E7D32" d="M10,40c0,0,0-0.4,0-1.1c0-0.3,0-0.8,0-1.3c0-0.3,0-0.5,0-0.8c0-0.3,0.1-0.6,0.1-0.9c0.1-0.6,0.1-1.4,0.2-2.1
                c0.2-0.8,0.3-1.6,0.5-2.5c0.2-0.9,0.6-1.8,0.8-2.8c0.3-1,0.8-1.9,1.2-3c0.5-1,1.1-2,1.7-3.1c0.7-1,1.4-2.1,2.2-3.1
                c1.6-2.1,3.7-3.9,6-5.6c2.3-1.7,5-3,7.9-4.1c0.7-0.2,1.5-0.4,2.2-0.7c0.7-0.3,1.5-0.3,2.3-0.5c0.8-0.2,1.5-0.3,2.3-0.4l1.2-0.1
                l0.6-0.1l0.3,0l0.1,0l0.1,0l0,0c0.1,0-0.1,0,0.1,0c1.5,0,2.9-0.1,4.5,0.2c0.8,0.1,1.6,0.1,2.4,0.3c0.8,0.2,1.5,0.3,2.3,0.5
                c3,0.8,5.9,2,8.5,3.6c2.6,1.6,4.9,3.4,6.8,5.4c1,1,1.8,2.1,2.7,3.1c0.8,1.1,1.5,2.1,2.1,3.2c0.6,1.1,1.2,2.1,1.6,3.1
                c0.4,1,0.9,2,1.2,3c0.3,1,0.6,1.9,0.8,2.7c0.2,0.9,0.3,1.6,0.5,2.4c0.1,0.4,0.1,0.7,0.2,1c0,0.3,0.1,0.6,0.1,0.9
                c0.1,0.6,0.1,1,0.1,1.4C74,39.6,74,40,74,40c0.2,2.2-1.5,4.1-3.7,4.3s-4.1-1.5-4.3-3.7c0-0.1,0-0.2,0-0.3l0-0.4c0,0,0-0.3,0-0.9
                c0-0.3,0-0.7,0-1.1c0 0.2,0-0.5,0-0.7c0-0.2-0.1-0.5-0.1-0.8c-0.1-0.6-0.1-1.2-0.2-1.9c-0.1-0.7-0.3-1.4-0.4-2.2
                c-0.2-0.8-0.5-1.6-0.7-2.4c-0.3-0.8-0.7-1.7-1.1-2.6c-0.5-0.9-0.9-1.8-1.5-2.7c-0.6-0.9-1.2-1.8-1.9-2.7c-1.4-1.8-3.2-3.4-5.2-4.9
                c-2-1.5-4.4-2.7-6.9-3.6c-0.6-0.2-1.3-0.4-1.9-0.6c-0.7-0.2-1.3-0.3-1.9-0.4c-1.2-0.3-2.8-0.4-4.2-0.5l-2,0c-0.7,0-1.4,0.1-2.1,0.1
                c-0.7,0.1-1.4,0.1-2,0.3c-0.7,0.1-1.3,0.3-2,0.4c-2.6,0.7-5.2,1.7-7.5,3.1c-2.2,1.4-4.3,2.9-6,4.7c-0.9,0.8-1.6,1.8-2.4,2.7
                c-0.7,0.9-1.3,1.9-1.9,2.8c-0.5,1-1,1.9-1.4,2.8c-0.4,0.9-0.8,1.8-1,2.6c-0.3,0.9-0.5,1.6-0.7,2.4c-0.2,0.7-0.3,1.4-0.4,2.1
                c-0.1,0.3-0.1,0.6-0.2,0.9c0,0.3-0.1,0.6-0.1,0.8c0,0.5-0.1,0.9-0.1,1.3C10,39.6,10,40,10,40z">
            </path>
        </svg>
    </div>

    <!-- Main Content - More Compact -->
    <div class="login-container">
        <div class="login-card">
            <div class="card-header">
                <img src="{% static 'mulogo.png' %}" alt="Murang'a University Logo" class="logo">
                <h1 class="welcome-text">Welcome Back</h1>
                <p class="subtitle">Sign in to access your account</p>
            </div>

            <div class="card-body">
                <!-- Django Messages -->
                {% if messages %}
                    <div class="messages">
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }}">
                                {% if message.tags == 'success' %}
                                    <i class="ri-checkbox-circle-fill"></i>
                                {% elif message.tags == 'error' %}
                                    <i class="ri-error-warning-fill"></i>
                                {% elif message.tags == 'warning' %}
                                    <i class="ri-alert-fill"></i>
                                {% else %}
                                    <i class="ri-information-fill"></i>
                                {% endif %}
                                <span>{{ message }}</span>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

                <form method="post" action="{% url 'login' %}">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label for="loginusername" class="form-label">
                            Email / Registration Number
                        </label>
                        <input 
                            type="text" 
                            id="loginusername" 
                            name="loginusername"
                            class="form-control"
                            placeholder="Enter email or registration number"
                            required
                            autocomplete="username"
                            aria-required="true"
                        >
                    </div>

                    <div class="form-group">
                        <label for="loginpassword" class="form-label">
                            Password
                        </label>
                        <div class="input-group">
                            <input 
                                type="password" 
                                id="loginpassword" 
                                name="loginpassword"
                                class="form-control"
                                placeholder="Enter your password"
                                required
                                autocomplete="current-password"
                                aria-required="true"
                            >
                            <div class="input-group-append" id="togglePassword">
                                <i class="ri-eye-off-line toggle-password"></i>
                            </div>
                        </div>
                    </div>

                    <div class="form-group flex-between">
                        <div class="checkbox-group">
                            <input 
                                type="checkbox" 
                                id="RememberMe" 
                                name="RememberMe" 
                                value="true"
                                class="checkbox-input"
                            >
                            <label for="RememberMe" class="checkbox-label">
                                Remember me
                            </label>
                        </div>
                        <a href="#" class="forgot-link">
                            Forgot Password?
                        </a>
                    </div>

                    <button type="submit" class="btn">
                        Sign In
                    </button>
                </form>

                <div class="footer mt-3">
                    <p class="mb-3">
                        Don't have an account? 
                        <a href="#" class="signup-link">Sign Up</a>
                    </p>
                    <div class="copyright">
                        Copyright &copy; 
                        <script>document.write(new Date().getFullYear());</script>
                         - Murang'a University of Technology
                        <br>
                        <small>Powered by InnovationHub Softwares</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Hide loader when page loads
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('loader').classList.add('hidden');
            }, 300);
        });

        // Toggle password visibility
        const togglePassword = document.getElementById('togglePassword');
        if (togglePassword) {
            togglePassword.addEventListener('click', function() {
                const passwordInput = document.getElementById('loginpassword');
                const icon = this.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('ri-eye-off-line');
                    icon.classList.add('ri-eye-line');
                    this.setAttribute('aria-label', 'Hide password');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('ri-eye-line');
                    icon.classList.add('ri-eye-off-line');
                    this.setAttribute('aria-label', 'Show password');
                }
            });

            // Keyboard support
            togglePassword.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });

            // Accessibility
            togglePassword.setAttribute('role', 'button');
            togglePassword.setAttribute('tabindex', '0');
        }

        // Form validation
        const form = document.querySelector('form');
        if (form) {
            form.addEventListener('submit', function(e) {
                const username = document.getElementById('loginusername');
                const password = document.getElementById('loginpassword');
                let hasError = false;
                
                if (!username.value.trim()) {
                    username.style.borderColor = '#C62828';
                    hasError = true;
                }
                if (!password.value.trim()) {
                    password.style.borderColor = '#C62828';
                    hasError = true;
                }
                
                if (hasError) {
                    e.preventDefault();
                    // Focus first error field
                    if (!username.value.trim()) {
                        username.focus();
                    } else if (!password.value.trim()) {
                        password.focus();
                    }
                }
            });

            // Remove error state on input
            const inputs = document.querySelectorAll('.form-control');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.style.borderColor = '';
                });
            });
        }
    </script>
</body>
</html>